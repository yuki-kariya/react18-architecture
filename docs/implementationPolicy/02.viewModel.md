# ViewModel 実装ルール

## 定義

ViewModel とは アプリケーションの関心ごと(≒ ドメイン)を、FE の UI 要件に合わせて再定義したデータモデル。

### ドメイン ViewModel

### 値オブジェクト ViewModel

## フォルダ構成のルール

> `viewModels/{ViewModel名}`

## 実装ルール

既に存在する単一の型や、複数の型を組み合わせてエイリアスをつける場合は `type` を使用する。

データ構造を定義したい場合は`interface`を使用する。

リテラル型を定義したい場合、リテラルを保持する定数とリテラル型を export する。

UUID など、型情報とは別にバリデーションロジックが存在する場合は、`is`演算子を使用した型ガード関数も定義する。

```ts
// viewModels/Label.ts

export type Label = React.ReactNode;

// viewModels/Placeholder.ts

export type Placeholder = React.ReactNode;

// viewModels/Option.ts

export const EMPTY_OPTION_VALUE = "";

export type EmptyOptionValue = typeof EMPTY_OPTION_VALUE;

export interface OptionItem {
  label?: Label;
  value: string;
  placeHolder?: Placeholder;
  isDisabled?: boolean;
}

// viewModels/Uuid.ts

export type Uuid = string;

// viewModels/Email.ts

export type Email = string;

export interface IsEmail {
  (candidate: unknown): candidate is Email;
}

export const isEmail: IsEmail = (candidate) => {
  // メールアドレスを形式をチェックするロジック
  return true;
};

// viewModels/FormField.ts

export const VALIDATION_RULES = [
  "required",
  "min",
  "max",
  "oneOf",
  "pattern",
] as const;

export type ValidationRules = (typeof VALIDATION_RULES)[number];

export interface FormField {
  title?: Label;
  subTitle?: Label;
  options?: OptionItem[];
  error?: Record<ValidationRules, string>;
}

// viewModels/ProfileForm.ts

interface EmailField extends FormField {
  title: Label;
  subTitle?: Label;
  options: never;
  error: never;
}

interface NameField extends FormField {
  title: Label;
  subTitle: Label;
  options: never;
  error: never;
}

export interface ProfileForm {
  defaultValue: {
    // 既に登録済みのプロフィールの場合は値が指定される
    id?: Uuid;
    email: Email;
    firstname?: string;
    lastname?: string;
  };
  title: Label;
  emailField: EmailField;
  firstnameField: NameField;
  lastnameField: NameFiled;
}
```
